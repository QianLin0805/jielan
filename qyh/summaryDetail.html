<!doctype html>
<html>
<head>
<meta http-equiv="Content-type" content="text/html;charset=utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
<meta name = "format-detection" content = "telephone=no">
<title>会议纪要</title>
<link rel="stylesheet" href="css/style.css" />
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/js.js"></script>
<style type="text/css">
.wrap{width: 100%;overflow: hidden;display: none;}
.no{line-height: 50px;font-size: 15px;text-align: center;color: #ccc;margin-top: 20px;display: none;}
h3{width: 80%;margin: 20px auto 0;font-size: 16px;color: #333;line-height: 20px;text-align: center;}
.time{color: #808080;font-size: 13px;line-height: 40px;text-indent: 10px;}
.content{padding: 0 10px 20px;color: #666;line-height: 22px;text-indent: 2em;text-align: justify;margin-bottom: 51px;}
.top{padding: 0 10px;height: 50px;line-height: 50px;position: fixed;left: 0;top: 0;right: 0;background: #fff;color: #333;font-size: 15px;}
.top a{width: 60px;line-height: 30px;background: #21becc;color: #fff;font-size: 14px;text-align: center;display: inline-block;float: right;margin-top: 10px;border-radius: 3px;}
.bottom{line-height: 40px;padding: 5px 10px;border-top: 1px solid #e0e0e0;position: fixed;left: 0;bottom: 0;right: 0;color: #333;background: #f0f0f0;}
.bottom span{ display: block; float: left; width: 75%;overflow: hidden;white-space: nowrap;text-overflow: ellipsis;}
.bottom a{float: right;margin: 5px 10px 0 0;font-size: 13px;width: 60px;line-height: 30px;background: #21becc;color: #fff;border-radius: 3px;text-align: center;}
</style>
</head>
<body>
<p class="tip">数据加载中...</p>
<div class="wrap" ng-app="myApp" ng-controller="dataCtrl">
	<p class="no"></p>
	<h3>{{data.title}}</h3>
	<p class="time">{{data.creTime}}</p>
	<div class="content">
		<p ng-bind-html="data.content|trustHtml"></p>
	</div>
	<div class="bottom" ng-if="files">
		<ol>
			<li ng-repeat="x in data.filesMinutes" ng-if="x.fileName">
				<span>{{$index+1}}.{{ x.fileName }}</span> 
				<a href={{x.fileUrl}} class="download">查看</a>
			</li>
		</ol>
	</div>
</div>
<p class="tishi"></p>
</body>
</html>
<script type="text/javascript" src="js/angular.js"></script>
<script type="text/javascript">
var meetingId = getQueryString('meetingId');
angular.module('myApp',[]).filter('trustHtml', function ($sce) {
        return function (input) {
            return $sce.trustAsHtml(input);
        }
    }).controller('dataCtrl',function($scope,$http){
	$http({
		url: link+"minuteDetailByMeeting.do",
		data: {
			"meetingId":meetingId
		},
	    method: 'POST',
	    headers: {'Content-Type': 'application/x-www-form-urlencoded'},
	    transformRequest: function(obj) {
	        var str = [];
	        for(var p in obj)
	        str.push(encodeURIComponent(p) + "=" + encodeURIComponent(obj[p]));
	        return str.join("&");
	    }
	}).success(function(response){
		if(response.resultCode!=200){
			$('.tishi').text('无会议纪要').show();
			$('.tip').hide();
			tishi();
			return;
		}
		$('.tip').hide();
		$('.wrap').show();
		$scope.data = response.resultContent;
		for(var i=0;i<$scope.data.filesMinutes.length;i++){
			if($scope.data.filesMinutes[i].fileName){
				$scope.files = true;
			}
		}
		if(response.resultContent==''){
			$('.no').show();
		}
	});
});
</script>